{"version":3,"file":"vue.js","sources":["../src/observer/index.js","../src/index.js"],"sourcesContent":["function defineReactive(obj, key, val, cb) {\r\n  // obj中的每一个key 都有 闭包val\r\n  Object.defineProperty(obj, key, {\r\n    get() {\r\n      console.log(`观察：在获取${obj}的值${key}`);\r\n      return val;\r\n    },\r\n    set(newValue) {\r\n      console.log(`观察：在这里改变了${val}`);\r\n      val = newValue;\r\n      cb && cb();\r\n    },\r\n  });\r\n}\r\n\r\nexport class Observer {\r\n  constructor(data) {\r\n    this.walk(data);\r\n  }\r\n  // 方法\r\n  walk(data) {\r\n    for (const [key, value] of Object.entries(data)) {\r\n      defineReactive(data, key, value);\r\n    }\r\n  }\r\n}\r\n\r\nexport function observe(data, cb) {\r\n  return new Observer(data);\r\n  //  对每一个键值操作\r\n  //   for (const [key, value] of Object.entries(data)) {\r\n  //     defineReactive(data, key, value, cb);\r\n  //   }\r\n}\r\n","import { observe } from \"./observer/index\";\r\n\r\n// 代理,代理这里是不可以defineReactive()会导致取值复制失效\r\nfunction _proxy(data) {\r\n  // 箭头函数内的this,是外层的this\r\n  Object.keys(data).forEach((key) => {\r\n    Object.defineProperty(this, key, {\r\n      get() {\r\n        console.log(`代理对象获取${data[key]}`)\r\n        return data[key];\r\n      },\r\n      set(newData) {\r\n        // 这里是一定要data[key]\r\n        data[key] = newData;\r\n        console.log(\"代理:值改变\", data[key]);\r\n      },\r\n    });\r\n  });\r\n}\r\n\r\n\r\nfunction initData(){\r\n    // 观察_data上的键值存取操作\r\n    observe(this._data)\r\n    // 数据代理，可以通过实例直接访问\r\n    _proxy.call(this,this._data)\r\n}\r\n\r\nfunction Vue(options) {\r\n  const vm = this;\r\n  vm.$options = options;\r\n  vm._data = typeof options.data === \"function\" ? options.data() : options.data;\r\n  initData.call(vm) // 直接调用this指向window,用call改变this\r\n}\r\n\r\nexport default Vue;\r\n"],"names":["defineReactive","obj","key","val","cb","Object","defineProperty","get","console","log","set","newValue","Observer","constructor","data","walk","value","entries","observe","_proxy","keys","forEach","newData","initData","_data","call","Vue","options","vm","$options"],"mappings":";;;;;;EAAA,SAASA,cAAcA,CAACC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,EAAE,EAAE;EACzC;EACAC,EAAAA,MAAM,CAACC,cAAc,CAACL,GAAG,EAAEC,GAAG,EAAE;EAC9BK,IAAAA,GAAGA,GAAG;QACJC,OAAO,CAACC,GAAG,CAAE,CAAA,MAAA,EAAQR,GAAI,CAAIC,EAAAA,EAAAA,GAAI,EAAC,CAAC,CAAA;EACnC,MAAA,OAAOC,GAAG,CAAA;OACX;MACDO,GAAGA,CAACC,QAAQ,EAAE;EACZH,MAAAA,OAAO,CAACC,GAAG,CAAE,CAAWN,SAAAA,EAAAA,GAAI,EAAC,CAAC,CAAA;EAC9BA,MAAAA,GAAG,GAAGQ,QAAQ,CAAA;QACdP,EAAE,IAAIA,EAAE,EAAE,CAAA;EACZ,KAAA;EACF,GAAC,CAAC,CAAA;EACJ,CAAA;EAEO,MAAMQ,QAAQ,CAAC;IACpBC,WAAWA,CAACC,IAAI,EAAE;EAChB,IAAA,IAAI,CAACC,IAAI,CAACD,IAAI,CAAC,CAAA;EACjB,GAAA;EACA;IACAC,IAAIA,CAACD,IAAI,EAAE;EACT,IAAA,KAAK,MAAM,CAACZ,GAAG,EAAEc,KAAK,CAAC,IAAIX,MAAM,CAACY,OAAO,CAACH,IAAI,CAAC,EAAE;EAC/Cd,MAAAA,cAAc,CAACc,IAAI,EAAEZ,GAAG,EAAEc,KAAK,CAAC,CAAA;EAClC,KAAA;EACF,GAAA;EACF,CAAA;EAEO,SAASE,OAAOA,CAACJ,IAAI,EAAEV,EAAE,EAAE;EAChC,EAAA,OAAO,IAAIQ,QAAQ,CAACE,IAAI,CAAC,CAAA;EACzB;EACA;EACA;EACA;EACF;;EC/BA;EACA,SAASK,MAAMA,CAACL,IAAI,EAAE;EACpB;IACAT,MAAM,CAACe,IAAI,CAACN,IAAI,CAAC,CAACO,OAAO,CAAEnB,GAAG,IAAK;EACjCG,IAAAA,MAAM,CAACC,cAAc,CAAC,IAAI,EAAEJ,GAAG,EAAE;EAC/BK,MAAAA,GAAGA,GAAG;UACJC,OAAO,CAACC,GAAG,CAAE,CAAA,MAAA,EAAQK,IAAI,CAACZ,GAAG,CAAE,CAAA,CAAC,CAAC,CAAA;UACjC,OAAOY,IAAI,CAACZ,GAAG,CAAC,CAAA;SACjB;QACDQ,GAAGA,CAACY,OAAO,EAAE;EACX;EACAR,QAAAA,IAAI,CAACZ,GAAG,CAAC,GAAGoB,OAAO,CAAA;UACnBd,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEK,IAAI,CAACZ,GAAG,CAAC,CAAC,CAAA;EAClC,OAAA;EACF,KAAC,CAAC,CAAA;EACJ,GAAC,CAAC,CAAA;EACJ,CAAA;EAGA,SAASqB,QAAQA,GAAE;EACf;EACAL,EAAAA,OAAO,CAAC,IAAI,CAACM,KAAK,CAAC,CAAA;EACnB;IACAL,MAAM,CAACM,IAAI,CAAC,IAAI,EAAC,IAAI,CAACD,KAAK,CAAC,CAAA;EAChC,CAAA;EAEA,SAASE,GAAGA,CAACC,OAAO,EAAE;IACpB,MAAMC,EAAE,GAAG,IAAI,CAAA;IACfA,EAAE,CAACC,QAAQ,GAAGF,OAAO,CAAA;EACrBC,EAAAA,EAAE,CAACJ,KAAK,GAAG,OAAOG,OAAO,CAACb,IAAI,KAAK,UAAU,GAAGa,OAAO,CAACb,IAAI,EAAE,GAAGa,OAAO,CAACb,IAAI,CAAA;EAC7ES,EAAAA,QAAQ,CAACE,IAAI,CAACG,EAAE,CAAC,CAAC;EACpB;;;;;;;;"}